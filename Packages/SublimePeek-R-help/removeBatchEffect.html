<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 <html><head><title>R: Remove Batch Effect</title>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
 <link rel="stylesheet" type="text/css" href="R.css">
 </head><body>
 
 <table width="100%" summary="page for removeBatchEffect"><tr><td>removeBatchEffect</td><td align="right">R Documentation</td></tr></table>
 
 <h2>Remove Batch Effect</h2>
 
 <h3>Description</h3>
 
 
 <p>Remove batch effects from expression data.
 </p>
 
 
 <h3>Usage</h3>
 
 <pre>
 removeBatchEffect(x,batch=NULL,batch2=NULL,covariates=NULL,design=matrix(1,ncol(x),1))
 </pre>
 
 
 <h3>Arguments</h3>
 
 
 <table summary="R argblock">
 <tr valign="top"><td><code>x</code></td>
 <td>
 <p>numeric matrix, or any object that can be coerced to a matrix by <code>as.matrix(x)</code>, containing log-expression intensities for a series of microarrays.
 Rows correspond to probes and columns to arrays.</p>
 </td></tr>
 <tr valign="top"><td><code>batch</code></td>
 <td>
 <p>factor or vector indicating batches.</p>
 </td></tr>
 <tr valign="top"><td><code>batch2</code></td>
 <td>
 <p>factor or vector indicating batches.</p>
 </td></tr>
 <tr valign="top"><td><code>covariates</code></td>
 <td>
 <p>matrix or vector of covariates to be adjusted for.</p>
 </td></tr>
 <tr valign="top"><td><code>design</code></td>
 <td>
 <p>optional design matrix relating to treatment conditions to be preserved</p>
 </td></tr>
 </table>
 
 
 <h3>Details</h3>
 
 
 <p>This function is useful for removing batch effects, associated with hybridization time or other technical variables, prior to clustering or unsupervised analysis such as PCA or heatmaps.
 It is not intended to use with linear modelling.
 For linear modelling, it is better to include the batch factors in the linear model.
 </p>
 <p>The design matrix is used to describe comparisons between the samples, for example treatment effects, which should not be removed.
 </p>
 <p>The function (in effect) fits a linear model to the data, including both batches and regular treatments, then removes the component due to the batch effects.
 </p>
 
 
 <h3>Value</h3>
 
 
 <p>A numeric matrix of log-expression values with batch and covariate effects removed.
 </p>
 
 
 <h3>Author(s)</h3>
 
 <p>Gordon Smyth and Carolyn de Graaf</p>
 
 
 <h3>See Also</h3>
 
 
 <p>05.Normalization
 </p>
 
 
 </body></html>
